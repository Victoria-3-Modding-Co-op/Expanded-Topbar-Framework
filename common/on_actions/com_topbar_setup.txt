# Setup on game start
on_game_started_after_lobby = {
	on_actions = {
		com_topbar_setup
	}
}

# Setup on game start
com_topbar_setup = {
	effect = {
		# Adding base game elements
		#= Prestige
		add_com_topbar_element = {
			element_name = com_topbar_element_prestige
		}
		#= Power Bloc Prestige
		add_com_topbar_element = {
			element_name = com_topbar_element_bloc_prestige
		}
		#= Power Bloc Cohesion
		add_com_topbar_element = {
			element_name = com_topbar_element_bloc_cohesion
		}
		#= Power Bloc Size
		add_com_topbar_element = {
			element_name = com_topbar_element_bloc_size
		}
		#= Legitimacy
		add_com_topbar_element = {
			element_name = com_topbar_element_legitimacy
		}
		#= Innovation
		add_com_topbar_element = {
			element_name = com_topbar_element_innovation
		}
		#= Companies
		add_com_topbar_element = {
			element_name = com_topbar_element_companies
		}
		#= Charters
		add_com_topbar_element = {
			element_name = com_topbar_element_charters
		}
		#= Army Size
		add_com_topbar_element = {
			element_name = com_topbar_element_army_size
		}
		#= Navy Size
		add_com_topbar_element = {
			element_name = com_topbar_element_navy_size
		}
		#= Interests
		add_com_topbar_element = {
			element_name = com_topbar_element_interests
		}

		# Setting up a default topbar
		every_country = {
			add_to_variable_list = {
				name = com_topbar_first_line
				target = scope:com_topbar_element_prestige
			}
			add_to_variable_list = {
				name = com_topbar_first_line
				target = scope:com_topbar_element_legitimacy
			}
			add_to_variable_list = {
				name = com_topbar_first_line
				target = scope:com_topbar_element_innovation
			}
			add_to_variable_list = {
				name = com_topbar_first_line
				target = scope:com_topbar_element_companies
			}
			add_to_variable_list = {
				name = com_topbar_first_line
				target = scope:com_topbar_element_interests
			}
			add_to_variable_list = {
				name = com_topbar_first_line
				target = scope:com_topbar_element_army_size
			}
			add_to_variable_list = {
				name = com_topbar_first_line
				target = scope:com_topbar_element_navy_size
			}
		}
	}
}


# Adding base game elements if they are missing
on_monthly_pulse_country = {
	on_actions = {
		com_topbar_save_game_compatibility
	}
}

# Adding base game elements if they are missing
com_topbar_save_game_compatibility = {
	effect = {
		#= Prestige
		if = {
			limit = {
				NOT = {
					any_in_global_list = {
						variable = com_topbar_items
						var:com_name ?= flag:com_topbar_element_prestige
					}
				}
			}
			add_com_topbar_element = {
				element_name = com_topbar_element_prestige
			}
			every_country = {
				add_to_variable_list = {
					name = com_topbar_first_line
					target = scope:com_topbar_element_prestige
				}
			}
		}
		#= Power Bloc Prestige
		if = {
			limit = {
				NOT = {
					any_in_global_list = {
						variable = com_topbar_items
						var:com_name ?= flag:com_topbar_element_bloc_prestige
					}
				}
			}
			add_com_topbar_element = {
				element_name = com_topbar_element_bloc_prestige
			}
			every_country = {
				add_to_variable_list = {
					name = com_topbar_first_line
					target = scope:com_topbar_element_bloc_prestige
				}
			}
		}
		#= Power Bloc Cohesion
		if = {
			limit = {
				NOT = {
					any_in_global_list = {
						variable = com_topbar_items
						var:com_name ?= flag:com_topbar_element_bloc_cohesion
					}
				}
			}
			add_com_topbar_element = {
				element_name = com_topbar_element_bloc_cohesion
			}
			every_country = {
				add_to_variable_list = {
					name = com_topbar_first_line
					target = scope:com_topbar_element_bloc_cohesion
				}
			}
		}
		#= Power Bloc Size
		if = {
			limit = {
				NOT = {
					any_in_global_list = {
						variable = com_topbar_items
						var:com_name ?= flag:com_topbar_element_bloc_size
					}
				}
			}
			add_com_topbar_element = {
				element_name = com_topbar_element_bloc_size
			}
			every_country = {
				add_to_variable_list = {
					name = com_topbar_first_line
					target = scope:com_topbar_element_bloc_size
				}
			}
		}
		#= Legitimacy
		if = {
			limit = {
				NOT = {
					any_in_global_list = {
						variable = com_topbar_items
						var:com_name ?= flag:com_topbar_element_legitimacy
					}
				}
			}
			add_com_topbar_element = {
				element_name = com_topbar_element_legitimacy
			}
			every_country = {
				add_to_variable_list = {
					name = com_topbar_first_line
					target = scope:com_topbar_element_legitimacy
				}
			}
		}
		#= Innovation
		if = {
			limit = {
				NOT = {
					any_in_global_list = {
						variable = com_topbar_items
						var:com_name ?= flag:com_topbar_element_innovation
					}
				}
			}
			add_com_topbar_element = {
				element_name = com_topbar_element_innovation
			}
			every_country = {
				add_to_variable_list = {
					name = com_topbar_first_line
					target = scope:com_topbar_element_innovation
				}
			}
		}
		#= Companies
		if = {
			limit = {
				NOT = {
					any_in_global_list = {
						variable = com_topbar_items
						var:com_name ?= flag:com_topbar_element_companies
					}
				}
			}
			add_com_topbar_element = {
				element_name = com_topbar_element_companies
			}
			every_country = {
				add_to_variable_list = {
					name = com_topbar_first_line
					target = scope:com_topbar_element_companies
				}
			}
		}
		#= Charters
		if = {
			limit = {
				NOT = {
					any_in_global_list = {
						variable = com_topbar_items
						var:com_name ?= flag:com_topbar_element_charters
					}
				}
			}
			add_com_topbar_element = {
				element_name = com_topbar_element_charters
			}
			every_country = {
				add_to_variable_list = {
					name = com_topbar_first_line
					target = scope:com_topbar_element_charters
				}
			}
		}
		#= Army Size
		if = {
			limit = {
				NOT = {
					any_in_global_list = {
						variable = com_topbar_items
						var:com_name ?= flag:com_topbar_element_army_size
					}
				}
			}
			add_com_topbar_element = {
				element_name = com_topbar_element_army_size
			}
			every_country = {
				add_to_variable_list = {
					name = com_topbar_first_line
					target = scope:com_topbar_element_army_size
				}
			}
		}
		#= Navy Size
		if = {
			limit = {
				NOT = {
					any_in_global_list = {
						variable = com_topbar_items
						var:com_name ?= flag:com_topbar_element_navy_size
					}
				}
			}
			add_com_topbar_element = {
				element_name = com_topbar_element_navy_size
			}
			every_country = {
				add_to_variable_list = {
					name = com_topbar_first_line
					target = scope:com_topbar_element_navy_size
				}
			}
		}
		#= Interests
		if = {
			limit = {
				NOT = {
					any_in_global_list = {
						variable = com_topbar_items
						var:com_name ?= flag:com_topbar_element_interests
					}
				}
			}
			add_com_topbar_element = {
				element_name = com_topbar_element_interests
			}
			every_country = {
				add_to_variable_list = {
					name = com_topbar_first_line
					target = scope:com_topbar_element_interests
				}
			}
		}
	}
}